---
title: "qntz"
date: 2023-10-12
---

### 0. Intoduction

### 1. The general rules
Specifically for pytorch-to-engine conversion there are some general rules that do now depend on the method of coversion that you chose:
- The model has to be single-device
- All data has to be pytorch tensors, so no numpy array 
- The functions used indise a model have to be pytorch functions(for example, no OpenCV functions)

### 2. The pytorch model-ONNX-TensorRT
-What is ONNX model?
ONNX (Open Neural Network Exchange) is a serialized representation of the model, and it can be used with various deep learning frameworks and runtime libraries that support the ONNX standard. ONNX files contain model architectures, layer configurations, and learnable parameters in a platform-independent format. ONNX is supported by a wide ecosystem of tools and libraries, enabling efficient inference on various hardware and platforms. A resulting .onnx file can be used both for using a model in another DL framework and deploying the model in TensorRT. 
-How does the pytorch.onnx function works?
The code to transform a PyTorch model to ONNX looks like this:
'''
import torch
import torchvision.models as models
import torch.onnx as onnx

def transform_model_to_onnx(model, onnx_filename):
    # Create a pre-trained PyTorch model
    model = models.resnet18(pretrained=True)
    model.eval()

    # Create example input data
    input_data = torch.randn(1, 3, 224, 224)

    # Export the model to ONNX format
    torch.onnx.export(model, input_data, onnx_filename, verbose=True, opset_version=11)
    
'''
